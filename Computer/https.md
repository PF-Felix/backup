# 加密算法

【对称加密】同一个密钥可以同时用作信息的加密和解密
【非对称加密】公钥加密的数据【只能】用私钥解密，私钥加密的数据可以用公钥解密

上面两种算法都是可逆算法，还有一种算法是【散列算法】不会被逆向破解

# http的痛点

http 请求和响应被攻击者拦截，攻击者就能查看传输的数据，也能伪造数据发送给服务端

那么怎么防止**数据泄密**和**伪造请求**？

# 怎么办

说黑话就完了，我用加密算法把数据加密后发送让你看不懂
但是攻击者可以从客户端获取加密算法，从而破解请求数据+发送伪造数据

【解决方案】
【破解请求数据】可以用非对称加密 or 对称加密加盐 解决，但是【还有问题看下文】
【发送伪造数据】优化的办法是加密加盐，但是【还有问题看下文】
【固定值盐】攻击者可以从客户端获取盐，没有意义，无效方案
【随机盐】盐的传输有风险，对称加密风险同上，非对称加密【还有问题看下文】

**【全程非对称加密】VS【先非对称加密传输盐，后续对称加密传输数据】**

对称加密比非对称加密速度快，使用第二个方案

综上来看，【非对称加密+对称加密】就可以解决问题？【还有问题，即公钥真实性问题】

**公钥真实性问题**

客户端公钥是哪来的？是服务端下发的，但是这个公钥也可以伪造
为什么不把公钥内置在客户端？移动应用可以这样做，但web浏览器总不能内置所有网站的公钥

攻击者存储一对假公钥和假私钥

攻击者拦截服务端的响应，获得真公钥，然后把假公钥下发给客户端，之后拦截客户端的请求用假私钥查看传输的盐，用真公钥和盐加密伪造的数据发给服务端

# 如何保证公钥的真实性

使用证书，证书由 CA机构发给服务端，客户端都内置有 CA公钥

下图中的【第三方】就是 CA机构

<img src="C:\ImageA\20231007095703.png" style="zoom:67%;" />

![](C:\ImageA\20231007095719.png)

攻击者可以拿到公钥解密证书，攻击者没有私钥无法伪造有效的证书
因此客户端要么认定证书无效，要么拿到有效的证书+真实公钥

客户端给服务端发送的盐是公钥加密的，攻击者没有私钥无法解密就得不到盐
客户端与服务端传输的加密数据是加盐的，攻击者没有盐就无法破解，能解决【数据泄密】

但是攻击者有公钥可以伪造盐发送，攻击者有了伪造盐
可以伪造请求数据，但是数据格式它不知道，即使知道，只要服务端的响应数据【脱敏】就没问题
可以伪造返回数据，但是客户端无法解密因为盐不对，也不是问题

# https的原理

上面的解决方案就是 https

https = http + SSL = 四次握手 + http

<img src="C:\ImageA\20231007095618.png" style="zoom:67%;" />

解释下：
下发证书，里面有公钥
随机数就是加密算法加密时使用的盐